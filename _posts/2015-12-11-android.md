---
layout: post
title:  "Android 基础"
date:   2016-1-26 15:08:05
categories: Android
excerpt: 
---

* content
{:toc}

### Android 基础知识点： 

---

#### android:layout_gravity和android:gravity属性的区别 ：

* gravity的中文意思就是"重心"，就是表示view横向和纵向的停靠位置;

* android:gravity：是对view控件本身来说的，是用来设置view本身的内容应该显示在view的什么位置,默认值是左侧。

* android:layout_gravity：是相对于包含改元素的父元素来说的，设置该元素在父元素的什么位置;

* 比如TextView: android:layout_gravity表示TextView在界面上的位置，android:gravity表示TextView文本在TextView的什么位置，默认值是左侧.

---

#### 设置颜色

        Android 代码中使用Color工具类 方法parseColor解析
        view.setBackgroundColor(Color.parseColor("#365663"));
        
---

#### 添加分割线的方法

* 自己在drawable下新建xml文件，然后在textView引用
        
        实线
        <?xml version="1.0" encoding="utf-8"?>
        <shape xmlns:android="http://schemas.android.com/apk/res/android"
            android:shape="line" >
            
            <stroke 
                android:color="#d4d4d4" />
            
        </shape>
        
        虚线
        <?xml version="1.0" encoding="utf-8"?>  
        <shape xmlns:android="http://schemas.android.com/apk/res/android"  
            android:shape="line" >  
            <stroke  
                android:dashGap="3dp"  
                android:dashWidth="6dp"  
                android:width="1dp"  
                android:color="#63a219" />  
            <!-- 虚线的高度 -->  
            <size android:height="1dp" />  
        </shape>  
        
        <TextView
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:background="@drawable/line" />

* 使用view

        <View 
           android:id="@+id/tab_line"
           android:layout_width="match_parent"
           android:layout_height="1dp"
           android:background="#d4d4d4"
           android:layout_alignParentBottom="true"/>
 
* 添加竖线

        <ImageView
            android:layout_width="1dp"
            android:layout_height="match_parent"
            android:layout_marginTop="1dp"
            android:background="#ebebeb"
            android:layout_gravity="center_horizontal" />
            
---

#### listView相关

* 要想让ListView显示底部的分割线，需要同时满足以下的选项:
        1）mFooterDividersEnabled 必须为true，其默认值是true的
        2)ListView的高度必须为match_parent。

* listview的应用中很常见的一种便是item的布局不是简单的一种，对于有多种布局的情况，一般需要重写适配器adapter

        思路为：
        1. 首先为不同的item类型编写布局layout文件和class类文件
        2. 选好用来传递数据给适配器的工具,常见的有HashMap<String, Object> map、ArrayList<Message> moreItemList;如：
            使用message来传递信息：            
            moreItemList = new ArrayList<Message>();
            MoreItem free_collect = new MoreItem("免费收录", R.drawable.free_collect, R.drawable.tag_more);
            Message collect = new Message();
            collect.obj = free_collect;     //obj用来传递数据
            collect.what = img_text;    //what作为标记位
            moreItemList.add(collect);
            
            取信息：
            Message msg = moreItemList.get(position);
            holderText.text.setText(msg.obj.toString());
            holderImageText.image.setImageResource(((MoreItem)msg.obj).getImageId());
            
        3. 初始化数据
        4. MoreItemAdapter adapter = new MoreItemAdapter(MoreActivity.this, moreItemList);
            moreListView.setAdapter(adapter);

---

#### intent 传递图片
        
        #发送图片
        Intent intent = new Intent(this.mContext, AccountDetailActivity.class);
        holder.account_image.setDrawingCacheEnabled(true);
        intent.putExtra("account_img", holder.account_image.getDrawingCache());
        this.mContext.startActivity(intent);
        
        #接收图片
        Bitmap bitmap = (Bitmap) getIntent().getParcelableExtra("account_img");
        Matrix matrix = new Matrix();//放大图片
        matrix.postScale(1.2f, 1.2f);
        Bitmap bm = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);
        accountImg.setImageBitmap(bm);
        
---

#### 颜色

        android 定义颜色color时6位或8位值的区别
    　　6位（#000000）就是RGB值
    　　8位（#1e000000）头两位是透明度，后6位是RGB值，00是完全透明，ff是完全不透明，比较适中的透明度值是 1e

---

#### 点击事件的设置

        LinearLayout category;
        category.setClickable(true);//使能点击,false则不能点击
        category.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(mContext, ChildCatsActivity.class);
                mContext.startActivity(intent);
            }
        });

---

#### 点击改变imageView的图片资源ID

        like.setOnClickListener(new OnClickListener() {
			
			@Override
			public void onClick(View v) {
				Integer integer = (Integer) like.getTag();
				integer = integer == null ? 0 : integer;
				switch(integer) {
				case R.drawable.like_normal:
					like.setImageResource(R.drawable.like_select);
					like.setTag(R.drawable.like_select);
					break;
				case R.drawable.like_select:
					like.setImageResource(R.drawable.like_normal);
					like.setTag(R.drawable.like_normal);
					break;
				default:
					like.setImageResource(R.drawable.like_normal);
					like.setTag(R.drawable.like_normal);
					break;
				}
			}
		});

---

#### 点击或者按压改变颜色，包括ImageView、TextView、Button等

        步骤一：在res/drawable目录下新建xml文件
        
        <?xml version="1.0" encoding="utf-8"?>
        <selector xmlns:android="http://schemas.android.com/apk/res/android" >
            
            //设置颜色
            <item android:state_pressed="true" android:color="#00bc44"/>    //按下时候的颜色
            <item android:state_pressed="false" android:color="#717171"/>
             
            //设置图片
            <item android:state_selected="true" android:drawable="@drawable/more_select" />     //被选中时的图片
    
            <item android:state_selected="false" android:drawable="@drawable/more_normal" />

        </selector>
        
        步骤二：在对应的ImageView、TextView、Button中设置属性，ImageView/Button的background属性，textView的color属性
        <TextView 
            android:id="@+id/subscribe_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="15dp"
            android:text="订阅"
            android:textSize="18sp"
            android:textColor="@drawable/subscribetext_selector"/>

---

#### 返回上一个活动：直接把当前的活动finish()

        tagBack.setOnClickListener(new OnClickListener() {
			@Override
			public void onClick(View v) {
				AccountDetailActivity.this.finish();
			}
		});

---

#### 复制信息到系统剪贴板

        // 从API11开始android推荐使用android.content.ClipboardManager
        // 为了兼容低版本我们这里使用旧版的android.text.ClipboardManager，虽然提示deprecated，但不影响使用。
        ClipboardManager cm = (ClipboardManager) getSystemService(Context.CLIPBOARD_SERVICE);
        // 将文本内容放到系统剪贴板里。
        cm.setText(tvMsg.getText());
        Toast.makeText(this, "复制成功，可以发给朋友们了。", Toast.LENGTH_LONG).show();

---

#### 打开其他应用，如微信等

        Intent intent = new Intent();

        ComponentName cmp = new ComponentName("com.sina.weibo","com.sina.weibo.EditActivity");
        intent.setAction(Intent.ACTION_MAIN);
        intent.addCategory(Intent.CATEGORY_LAUNCHER);
        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        intent.setComponent(cmp);
        startActivityForResult(intent, 0);
        
        几个常用的Package命令：

        新浪微博（编辑界面）：com.sina.weibo     com.sina.weibo.EditActivity

        腾讯微博（编辑界面）：com.tencent.WBlog    com.tencent.WBlog.activity.MicroblogInput

        微信：                com.tencent.mm      com.tencent.mm.ui.LauncherUI
        QQ:                   com.tencent.mobileqq com.tencent.mobileqq.activity.HomeActivity

---

#### ScrollView的简单应用

        <ScrollView 
            android:layout_width="match_parent" xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_height="match_parent"
            android:scrollbars="none"   //滚动条隐藏
            xmlns:tools="http://schemas.android.com/tools"></ScrollView>

---

#### 使用styles.xml编写布局

        项目中有时候会有很多重复的布局，这时候可以编写values/styles.xml，来避免重复写控件的属性：
        如：
        <style name="usercenter_text_bottom">
            <item name="android:layout_width">wrap_content</item>
            <item name="android:layout_height">wrap_content</item>
            <item name="android:textColor">#a6a6a6</item>
            <item name="android:textSize">14sp</item>
        </style>
        
        然后在布局对应的控件中引用：
        <TextView
            android:id="@+id/tv_user_message"
            android:text="10条未读消息"
            style="@style/usercenter_text_bottom"/>

---

#### 获取手机的imei码

        在manifest.xml文件中要添加 <uses-permission android:name="android.permission.READ_PHONE_STATE" />
        TelephonyManager tm = (TelephonyManager) this.getSystemService(TELEPHONY_SERVICE);  
        String imei = tm.getDeviceId();//String     

---

#### 通过资源名称获取资源ID

        ImageView iv = new ImageView(getContext());
        iv.setBackgroundResource(getResources().getIdentifier(getContext().getPackageName() + ":" + name, null, null));
        其中name可以是存储在json中的字符串，如：drawable/user_image;
        若json中存储的是user_image,则只要改":"为":drawable/"
        即第一个参数为完整的资源路径
        
---

#### EditText 

        <EditText
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:hint="请输入新的密码"
            android:background="@null"  //消除下划线等背景
            android:lines="1"
            android:maxLines="1"        //限制行数
            android:inputType="textPassword"    //限制输入的类型
            android:maxLength="10"              //限制最大输入字符个数为10 
            android:imeOptions="actionNext"     //设置输入法回车键的功能,如:actionNext,下一项；actionDone:完成
            android:layout_weight="1"
            android:textColor="#404040"
            android:textColorHint="#b4b4b4"     //设置提示的字体颜色
            android:textCursorDrawable="@null"/>    //设置光标的颜色，@null即表示与字体颜色一样
            
        密码不可见：editText.setTransformationMethod(PasswordTransformationMethod.getInstance());
        密码可见： editText.setTransformationMethod(HideReturnsTransformationMethod.getInstance());

---

#### 用framelayout实现图片上加提示数字

        <FrameLayout
            android:layout_width="60dp"
            android:layout_height="60dp"
            android:layout_marginRight="10dp">

            <ImageView
                android:id="@+id/iv_itemAlbum_img"
                android:layout_width="60dp"
                android:layout_height="60dp"
                android:layout_marginRight="5dp"
                android:src="@mipmap/placeholder_square"/>

            <TextView
                android:id="@+id/tv_album_item_count"
                android:layout_width="20dp"
                android:layout_height="20dp"
                android:layout_gravity="right|bottom"   //标记位于图片的右下角
                android:gravity="center"
                android:text="1"
                android:textColor="#ffffff"
                android:background="@drawable/shape_usercenter_item_album_count"/>

        </FrameLayout>

---

#### 时间格式转化

        import java.text.SimpleDateFormat;  
        import java.util.Date; 

        // 转化时间格式，例如：cc_time=1291778220
        private String getStrTime(String cc_time) {
            String re_StrTime = null;
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy年MM月dd日HH时mm分ss秒");
            long lcc_time = Long.valueOf(cc_time);
            re_StrTime = sdf.format(new Date(lcc_time * 1000L));

            return re_StrTime;
        }

---

#### 时间选择对话框，应用场景：选择生日等

        private static final int DATE_DIALOG = 0;
        private Calendar c = null;

        @Override
        protected Dialog onCreateDialog(int id) {

            Dialog dialog = null;
            switch (id) {
                case DATE_DIALOG:
                    c = Calendar.getInstance();
                    dialog = new DatePickerDialog(UserInformationActivity.this, new DatePickerDialog.OnDateSetListener() {
                        @Override
                        public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
                            birthday.setText(year + "年" + (monthOfYear + 1) + "月" + dayOfMonth + "日");
                        }
                    },
                    c.get(Calendar.YEAR),c.get(Calendar.MONTH),c.get(Calendar.DAY_OF_MONTH));

                    break;
            }
            return dialog;
        }
        
        直接调用showDialog(DATE_DIALOG);

---

#### 绑定手机

        Pattern phonePattern = Pattern.compile("^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$");
        Matcher phoneMatcher = phonePattern.matcher(phoneString);
        if (!phoneMatcher.matches()) {
            FLDDialogUtil.showErrorDialog(this, "亲， 请输入正确的手机号码");
        }
        
        //验证码重新发送倒计时
        new CountDownTimer(countDown*1000, 1000) {
            @Override
            public void onTick(long millisUntilFinished) {
                tvVerifyCode.setText(millisUntilFinished/1000 + "秒后重新发送");
            }

            @Override
            public void onFinish() {
                tvVerifyCode.setText("获取验证码");
                tvVerifyCode.setEnabled(true);
                countDownLooping = false;
            }

        }.start();


---

#### 项目中用到的开源插件

* [ImageLoader](https://github.com/nostra13/Android-Universal-Image-Loader)图片加载

* [ImagePicker](https://github.com/jeasonlzy0216/ImagePicker) 图片选择器

* [PagerSlidingTabStrip](https://github.com/astuetz/PagerSlidingTabStrip)水平滚动导航栏

* [okhttp](https://github.com/square/okhttp)网络请求

* [datetimepicker] (https://github.com/flavienlaurent/datetimepicker) 日历、时间选择

* [PermissionsDispatcher](https://github.com/hotchemi/PermissionsDispatcher) 运行时权限管理

* 官方的下拉刷新控件：SwipeRefreshLayout

* [SwipeMenuListView](https://github.com/baoyongzhang/SwipeMenuListView) listview滑动删除

---


> 参考文章：

---

### 结语：

坚持每天进步一点点...

---